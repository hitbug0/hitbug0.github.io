<!DOCTYPE html>
<html lang="en">
  <head prefix="og: https://ogp.me/ns#">
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="hitbug" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@hitbug0" />

    <meta property="og:url" content="https://hitbug0.github.io/posts_en/2024-04-22-AutoAddSitemap2Google.html" />
    <meta property="og:title" content="Automating Screen Operations with Python (Includes Various Code Snippets for Beginners)" />
    <meta property="og:image" content="https://avatars.githubusercontent.com/u/166343381?v=4?s=400" />
    <meta property="og:description" content="This article introduces methods to automate screen operations with Python.
        The example used here is "Registering an XML file with Google Search Console," but these methods can be applied to other scenarios as well, such as "performing the same operation repeatedly with software created by historical figures."
        (Note: These methods are based on recent versions of Windows, so they may not work on other operating systems or older versions of Windows. Please be aware of this...!)" />
    
    <link rel="alternate" hreflang="ja" href="https://hitbug0.github.io/posts/2024-04-22-AutoAddSitemap2Google.html" />
    <link rel="alternate" hreflang="en" href="https://hitbug0.github.io/posts_en/2024-04-22-AutoAddSitemap2Google.html" />
    
    
    <title>Automating Screen Operations with Python (Includes Various Code Snippets for Beginners) | hitbug</title>
    <meta name="tag" content="RPA">
    <meta name="tag" content=" Python">
    <meta name="tag" content=" Web Development">
    <meta name="description" content="This article introduces methods to automate screen operations with Python.
        The example used here is "Registering an XML file with Google Search Console," but these methods can be applied to other scenarios as well, such as "performing the same operation repeatedly with software created by historical figures."
        (Note: These methods are based on recent versions of Windows, so they may not work on other operating systems or older versions of Windows. Please be aware of this...!)" />

    <!-- 共通: 基本設定-->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../includes/style.css" />
    <link rel="icon" href="../contents/icon/hitbug-black-transparent.png" />

    <!-- 共通: フォントの設定-->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="anonymous" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" crossorigin="anonymous" />

    <!-- 共通: lightbox (ウェブサイト上で画像や動画を拡大表示するためのポップアップウィンドウ) の設定-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css" crossorigin="anonymous" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/js/lightbox.min.js" crossorigin="anonymous"></script>

    <!-- 共通: Google AdSenseの設定-->
    <meta name="google-adsense-account" content="ca-pub-5830432592137126" />
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5830432592137126"
        crossorigin="anonymous">
    </script>

    <!-- 共通: Google Analyticsの設定-->
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2NP6QCR05Z"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-2NP6QCR05Z');
    </script>

    <!-- 共通: コード表示とコピーの設定-->
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
  </head>
  <body>
    <!-- 共通: ヘッダ -->
    <header></header>
    <script>$(function(){$('header').load('../includes/header-en.html');});</script>

    <div id="wrapper">
        <div id="main">
            <!-- コンテンツ -->
            <div id="hidden-left-sidebar"></div>
            <div id="left-sidebar">
                <div id="left-share">
                    <h1 class="text">Share!</h1>
                    <a href="https://twitter.com/intent/tweet?url=https://hitbug0.github.io/posts_en/2024-04-22-AutoAddSitemap2Google.html&text=" class="twitter-share-button" data-show-count="false" rel="noopener noreferrer" target="_blank">
                        <img  class="twitter-share-button-img" src="../contents/icon/x.png" alt="logo of x">
                    </a>
                </div>
                <br>
                <div class="text">
                    <h1>In this article</h1>
                    <ul>
                        <li><a href="#section1">What You Will Learn from This Article</a></li>
                        <li><a href="#section2">What Tools Are Used for Automation?</a></li>
                        <li><a href="#section3">What Operations Can Be Automated?</a></li>
                        <li><a href="#section4">What Operations Are Automated This Time?</a></li>
                        <li><a href="#section5">What Does the Code Look Like?</a></li>
                        <li><a href="#section6">What Does the Execution Result Look Like?</a></li>
                        <li><a href="#section7">Summary</a></li>
                    </ul>
                </div>
                <br>
                <div id="left-sidebar-tags" class="text"></div>
                <script>$(function(){$('#left-sidebar-tags').load('../includes/tags-post-en.html');});</script>
            </div>
            <div id="center">
                <div class="text">


                    
<script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="automating-screen-operations-with-python-includes-various-code-snippets-for-beginners">Automating Screen Operations with Python (Includes Various Code Snippets for Beginners)</h1>
<p></p>
<hr/>
<p>This article introduces methods to automate screen operations with Python.<br/>
The example used here is "Registering an XML file with Google Search Console," but these methods can be applied to other scenarios as well, such as "performing the same operation repeatedly with software created by historical figures."<br/>
(Note: These methods are based on recent versions of Windows, so they may not work on other operating systems or older versions of Windows. Please be aware of this...!)</p>
<h2 id="section1">What You Will Learn from This Article</h2>
<ul>
<li>How to automate screen operations with Python
<ul>
<li>Basic commands</li>
<li>Handy functions</li>
</ul>
</li>
<li>Automation Example: Automating the process of registering an XML sitemap with Google Search Console
<ul>
<li>Step-by-step procedure</li>
<li>Code for automation</li>
<li>Execution results (video)</li>
</ul>
</li>
</ul>
<h2 id="section2">What Tools Are Used for Automation?</h2>
<p>Various operations can be automated with Python.<br/>
In this article, the following libraries were used.<br/>
While these libraries alone can achieve quite a bit, there are many other useful libraries out there.</p>
<ul>
<li><strong>PyAutoGUI</strong>
<ul>
<li>Automates GUI operations such as mouse movement and clicks, and keyboard inputs.</li>
</ul>
</li>
<li><strong>pyperclip</strong>
<ul>
<li>Allows reading and writing to the clipboard.</li>
</ul>
</li>
<li><strong>subprocess</strong>
<ul>
<li>Can start external processes and manipulate their input/output.</li>
<li>Especially useful for executing command prompt operations within Python.</li>
<li>It's a standard Python library, so no separate installation is required.</li>
</ul>
</li>
<li><strong>win32gui, win32con, win32api</strong>
<ul>
<li>Allows access to Windows GUI elements and system resources.</li>
</ul>
</li>
<li><strong>time</strong>
<ul>
<li>Provides functionalities such as obtaining the current time, pausing execution (sleep), performance measurement, converting time expressions, and performing time arithmetic.</li>
<li>It's a standard Python library, so no separate installation is required.</li>
</ul>
</li>
</ul>
<p>Here are the installation commands.<br/>
Note that <code>win32***</code> libraries are bundled and installed with <code>pywin32</code>!</p>
<div class="container"><div id="code-content0"><button class="copy-button" data-clipboard-target="#code-content0">Copy</button><pre class="hljs"><code><div>pip install pyperclip
pip install pyautogui
pip install pywin32
</div></code></pre></div></div>
<h2 id="section3">What Operations Can Be Automated?</h2>
<p>Here are some simple specific examples of the automation code used in this article.<br/>
These are just a few examples, but there are many other things you can automate!</p>
<h3 id="pressing-keys">Pressing Keys</h3>
<p>With PyAutoGUI, you can automate the pressing of one or more keys.<br/>
There are many other keys you can press, so feel free to explore further!</p>
<div class="container"><div id="code-content1"><button class="copy-button" data-clipboard-target="#code-content1">Copy</button><pre class="hljs"><code><div><span class="hljs-keyword">import</span> pyautogui <span class="hljs-keyword">as</span> pa

pa.hotkey(<span class="hljs-string">'alt'</span>,<span class="hljs-string">'d'</span>) <span class="hljs-comment"># Focus the URL input field in Google Chrome</span>
pa.hotkey(<span class="hljs-string">'f5'</span>) <span class="hljs-comment"># Refresh the page in the browser</span>
</div></code></pre></div></div>
<h3 id="typing-text">Typing Text</h3>
<p>You can use PyAutoGUI and pyperclip to type text.<br/>
To avoid issues with switching between Japanese/English input modes, it's better to use the "copy to clipboard and paste" method.</p>
<div class="container"><div id="code-content2"><button class="copy-button" data-clipboard-target="#code-content2">Copy</button><pre class="hljs"><code><div><span class="hljs-keyword">import</span> pyautogui <span class="hljs-keyword">as</span> pa
<span class="hljs-keyword">import</span> pyperclip

pyperclip.copy(<span class="hljs-string">"hoge, hoge"</span>) <span class="hljs-comment"># Copy text to clipboard</span>
pa.hotkey(<span class="hljs-string">'ctrl'</span>,<span class="hljs-string">'v'</span>) <span class="hljs-comment"># Paste the text</span>
</div></code></pre></div></div>
<h3 id="locating-an-image-on-the-screen-and-clicking">Locating an Image on the Screen and Clicking</h3>
<p>PyAutoGUI can search for images on the screen.<br/>
If found, it returns the center coordinates of the image's location.</p>
<div class="container"><div id="code-content3"><button class="copy-button" data-clipboard-target="#code-content3">Copy</button><pre class="hljs"><code><div><span class="hljs-keyword">import</span> pyautogui <span class="hljs-keyword">as</span> pa

position_im = pa.locateOnScreen(img, confidence=<span class="hljs-number">0.8</span>)
</div></code></pre></div></div>
<p>In this example, I defined a <code>wait_disp</code> function to wait for an image to appear.<br/>
Here's how it's used:</p>
<div class="container"><div id="code-content4"><button class="copy-button" data-clipboard-target="#code-content4">Copy</button><pre class="hljs"><code><div><span class="hljs-keyword">import</span> pyautogui <span class="hljs-keyword">as</span> pa

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wait_disp</span><span class="hljs-params">(img, wait_time=<span class="hljs-number">10</span>)</span>:</span>
    <span class="hljs-comment"># Waits for an image to appear on the screen. Returns the image's location if found.</span>
    dt = <span class="hljs-number">0.5</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(wait_time/dt)):
        position_im = pa.locateOnScreen(img, confidence=<span class="hljs-number">0.8</span>)
        <span class="hljs-keyword">if</span> position_im:
            <span class="hljs-keyword">return</span> position_im
        <span class="hljs-keyword">else</span>:
            time.sleep(dt)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

position_im = wait_disp(<span class="hljs-string">'./hoge.png'</span>) <span class="hljs-comment"># Search for hoge.png on the screen</span>
pa.click(position_im, button=<span class="hljs-string">'left'</span>, clicks=<span class="hljs-number">1</span>) <span class="hljs-comment"># Left-click the center of hoge.png</span>
</div></code></pre></div></div>
<h3 id="launching-applications">Launching Applications</h3>
<p>You can use subprocess to launch specified applications.<br/>
For example, you can start Google Chrome with the following code.</p>
<div class="container"><div id="code-content5"><button class="copy-button" data-clipboard-target="#code-content5">Copy</button><pre class="hljs"><code><div>chrome_path = <span class="hljs-string">"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"</span>
subprocess.Popen(chrome_path)
</div></code></pre></div></div>
<h3 id="adjusting-application-display-positionscreen-maximizing-etc">Adjusting Application Display Position/Screen, Maximizing, etc.</h3>
<p>Using win32gui, win32con, and win32api, you can adjust the display state of applications.<br/>
Sometimes, you may need to specify the window size if the buttons to be displayed are not visible in a small window.<br/>
I'll skip the detailed explanation here!</p>
<div class="container"><div id="code-content6"><button class="copy-button" data-clipboard-target="#code-content6">Copy</button><pre class="hljs"><code><div><span class="hljs-keyword">import</span> win32gui
<span class="hljs-keyword">import</span> win32con
<span class="hljs-keyword">import</span> win32api

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chrome_window</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># Retrieves the handle of the most recently opened Chrome window.</span>
    chrome_windows = []
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">enum_handler</span><span class="hljs-params">(hwnd, lParam)</span>:</span>
        <span class="hljs-keyword">if</span> win32gui.IsWindowVisible(hwnd) <span class="hljs-keyword">and</span> <span class="hljs-string">'chrome'</span> <span class="hljs-keyword">in</span> win32gui.GetWindowText(hwnd).lower():
            chrome_windows.append(hwnd)
    win32gui.EnumWindows(enum_handler, <span class="hljs-literal">None</span>)
    <span class="hljs-keyword">return</span> chrome_windows[<span class="hljs-number">0</span>] <span class="hljs-keyword">if</span> chrome_windows <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">move_to_main_screen</span><span class="hljs-params">(hwnd, wait_time=<span class="hljs-number">10</span>)</span>:</span>
    <span class="hljs-comment"># Switches the display monitor to the main device.</span>
    dt = <span class="hljs-number">0.5</span>
    n = wait_time/dt
    count=<span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> count&lt;=n:
        monitor_info = win32api.GetMonitorInfo(win32api.MonitorFromWindow(hwnd, win32con.MONITOR_DEFAULTTONEAREST))
        main_monitor_info = win32api.GetMonitorInfo(win32api.MonitorFromWindow(<span class="hljs-number">0</span>, win32con.MONITOR_DEFAULTTOPRIMARY))
        <span class="hljs-keyword">if</span> monitor_info[<span class="hljs-string">'Device'</span>] == main_monitor_info[<span class="hljs-string">'Device'</span>]:
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># Switch the monitor displaying hwnd</span>
            win32gui.MoveWindow(hwnd, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">500</span>, <span class="hljs-number">500</span>, <span class="hljs-literal">True</span>) <span class="hljs-comment"># Position the window at 500*500 from the top left corner</span>
            time.sleep(dt)
            count +=<span class="hljs-number">1</span>

<span class="hljs-comment"># Adjusting the display window</span>
chrome_window = <span class="hljs-literal">None</span>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> chrome_window:
    chrome_window = get_chrome_window()
    time.sleep(<span class="hljs-number">0.5</span>)

move_to_main_screen(chrome_window) <span class="hljs-comment"># Open in the main screen</span>
time.sleep(<span class="hljs-number">0.5</span>)

win32gui.ShowWindow(chrome_window, win32con.SW_MAXIMIZE) <span class="hljs-comment"># Maximize the window</span>
</div></code></pre></div></div>
<h2 id="section4">What Operations Are Automated This Time?</h2>
<p>This time, the operation being automated is the registration of an XML sitemap with Google Search Console.<br/>
Specifically, the operation involves the following steps:</p>
<ol>
<li>
<p>Launch Google Chrome</p>
</li>
<li>
<p>Adjust the display window</p>
<ul>
<li>Open in the main window</li>
<li>Maximize the window</li>
</ul>
</li>
<li>
<p>Enter the Google Search Console URL in the URL field of Google Chrome and press the <code>Enter</code> key</p>
</li>
<li>
<p>Confirm that the Google Search Console page has opened</p>
<ul>
<li>Find <code>sitemap1.png</code> on the screen</li>
</ul>
</li>
<li>
<p>Enter the file name (sitemap.xml) in the specified field</p>
<ul>
<li>After clicking <code>sitemap1.png</code> to focus on the input field, press the <code>Tab</code> key</li>
<li>Copy the file name to the clipboard and paste it into the input field</li>
</ul>
</li>
<li>
<p>Click the submit button (<code>sitemap2.png</code>)</p>
</li>
<li>
<p>Confirm that the submission process is complete and refresh the page</p>
<ul>
<li>When <code>sitemap3.png</code> (the button to close the submission completion popup) appears, click it</li>
<li>Wait for a moment and then press the <code>F5</code> key</li>
</ul>
</li>
</ol>
<p>Here are the images used as triggers for the automated operations.
<div class="photo-list"><a href="../contents/img/sitemap1.png" data-lightbox="group" data-title="sitemap1.png(Imageoftextonthepage)" alt="sitemap1.png(Imageoftextonthepage)">
                                   <img src="../contents/img/sitemap1.png" height="80px">
                                </a>
                             <a href="../contents/img/sitemap2.png" data-lightbox="group" data-title="sitemap2.png(Submitbutton)" alt="sitemap2.png(Submitbutton)">
                                   <img src="../contents/img/sitemap2.png" height="80px">
                                </a>
                             <a href="../contents/img/sitemap3.png" data-lightbox="group" data-title="sitemap3.png(Buttontoclosethepopup)" alt="sitemap3.png(Buttontoclosethepopup)">
                                   <img src="../contents/img/sitemap3.png" height="80px">
                                </a>
                             </div></p>
<h2 id="section5">What Does the Code Look Like?</h2>
<p>Here's the code!<br/>
At the very least, replace the URL at the beginning with your own!</p>
<div class="container"><div id="code-content7"><button class="copy-button" data-clipboard-target="#code-content7">Copy</button><pre class="hljs"><code><div><span class="hljs-keyword">import</span> pyautogui <span class="hljs-keyword">as</span> pa
<span class="hljs-keyword">import</span> pyperclip
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> subprocess
<span class="hljs-keyword">import</span> win32gui
<span class="hljs-keyword">import</span> win32con
<span class="hljs-keyword">import</span> win32api

URL = <span class="hljs-string">"https://search.google.com/search-console/sitemaps?resource_id=https%3A%2F%2Fhitbug0.github.io%2F"</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wait_disp</span><span class="hljs-params">(img, wait_time=<span class="hljs-number">10</span>)</span>:</span>
    <span class="hljs-comment"># Waits for an image to appear on the screen. Returns the image's location if found.</span>
    dt = <span class="hljs-number">0.5</span>
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(int(wait_time/dt)):
        position_im = pa.locateOnScreen(img, confidence=<span class="hljs-number">0.8</span>)
        <span class="hljs-keyword">if</span> position_im:
            <span class="hljs-keyword">return</span> position_im
        <span class="hljs-keyword">else</span>:
            time.sleep(dt)
    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_chrome_window</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># Retrieves the handle of the most recently opened Chrome window.</span>
    chrome_windows = []
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">enum_handler</span><span class="hljs-params">(hwnd, lParam)</span>:</span>
        <span class="hljs-keyword">if</span> win32gui.IsWindowVisible(hwnd) <span class="hljs-keyword">and</span> <span class="hljs-string">'chrome'</span> <span class="hljs-keyword">in</span> win32gui.GetWindowText(hwnd).lower():
            chrome_windows.append(hwnd)
    win32gui.EnumWindows(enum_handler, <span class="hljs-literal">None</span>)
    <span class="hljs-keyword">return</span> chrome_windows[<span class="hljs-number">0</span>] <span class="hljs-keyword">if</span> chrome_windows <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">move_to_main_screen</span><span class="hljs-params">(hwnd, wait_time=<span class="hljs-number">10</span>)</span>:</span>
    <span class="hljs-comment"># Switches the display monitor to the main device.</span>
    dt = <span class="hljs-number">0.5</span>
    n = wait_time/dt
    count=<span class="hljs-number">0</span>
    <span class="hljs-keyword">while</span> count&lt;=n:
        monitor_info = win32api.GetMonitorInfo(win32api.MonitorFromWindow

(hwnd, win32con.MONITOR_DEFAULTTONEAREST))
        main_monitor_info = win32api.GetMonitorInfo(win32api.MonitorFromWindow(<span class="hljs-number">0</span>, win32con.MONITOR_DEFAULTTOPRIMARY))
        <span class="hljs-keyword">if</span> monitor_info[<span class="hljs-string">'Device'</span>] == main_monitor_info[<span class="hljs-string">'Device'</span>]:
            <span class="hljs-keyword">break</span>
        <span class="hljs-keyword">else</span>:
            <span class="hljs-comment"># Switch the monitor displaying hwnd</span>
            win32gui.MoveWindow(hwnd, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">500</span>, <span class="hljs-number">500</span>, <span class="hljs-literal">True</span>) <span class="hljs-comment"># Position the window at 500*500 from the top left corner</span>
            time.sleep(dt)
            count +=<span class="hljs-number">1</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-comment"># Execute command to launch Google Chrome</span>
    chrome_path = <span class="hljs-string">"C:\\Program Files\\Google\\Chrome\\Application\\chrome.exe"</span>
    subprocess.Popen(chrome_path)
    
    <span class="hljs-comment"># Adjust the display window</span>
    time.sleep(<span class="hljs-number">0.5</span>)  <span class="hljs-comment"># Wait time for Chrome to launch</span>
    chrome_window = <span class="hljs-literal">None</span>
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> chrome_window:
        chrome_window = get_chrome_window()
        time.sleep(<span class="hljs-number">0.5</span>)
    
    move_to_main_screen(chrome_window) <span class="hljs-comment"># Open in the main screen</span>
    time.sleep(<span class="hljs-number">0.5</span>)
    
    win32gui.ShowWindow(chrome_window, win32con.SW_MAXIMIZE) <span class="hljs-comment"># Maximize the window</span>
    time.sleep(<span class="hljs-number">0.5</span>)
    
    <span class="hljs-comment"># Enter URL</span>
    pa.hotkey(<span class="hljs-string">'alt'</span>,<span class="hljs-string">'d'</span>)
    time.sleep(<span class="hljs-number">2</span>)
    pyperclip.copy(URL)
    pa.hotkey(<span class="hljs-string">'ctrl'</span>,<span class="hljs-string">'v'</span>)
    time.sleep(<span class="hljs-number">0.05</span>)
    pa.hotkey(<span class="hljs-string">'enter'</span>)

    <span class="hljs-comment"># Find and click sitemap1.png on the screen</span>
    time.sleep(<span class="hljs-number">0.05</span>)
    position_im = wait_disp(<span class="hljs-string">'./contents/img/sitemap1.png'</span>)
    pa.click(position_im, button=<span class="hljs-string">'left'</span>, clicks=<span class="hljs-number">1</span>)
    
    <span class="hljs-comment"># Enter file name and submit</span>
    pa.hotkey(<span class="hljs-string">'tab'</span>)
    time.sleep(<span class="hljs-number">0.05</span>)
    pyperclip.copy(<span class="hljs-string">"sitemap.xml"</span>)
    pa.hotkey(<span class="hljs-string">'ctrl'</span>,<span class="hljs-string">'v'</span>)
    time.sleep(<span class="hljs-number">0.05</span>)
    position_im = wait_disp(<span class="hljs-string">'./contents/img/sitemap2.png'</span>)
    pa.click(position_im, button=<span class="hljs-string">'left'</span>, clicks=<span class="hljs-number">1</span>)
    
    <span class="hljs-comment"># Refresh page after submission is complete</span>
    position_im = wait_disp(<span class="hljs-string">'./contents/img/sitemap3.png'</span>, wait_time=<span class="hljs-number">40</span>)
    time.sleep(<span class="hljs-number">0.05</span>)
    pa.click(position_im, button=<span class="hljs-string">'left'</span>, clicks=<span class="hljs-number">1</span>)
    time.sleep(<span class="hljs-number">1</span>)
    pa.hotkey(<span class="hljs-string">'f5'</span>)

main()
</div></code></pre></div></div>
<h2 id="section6">What Does the Execution Result Look Like?</h2>
<p>I'll upload a video soon!</p>
<h2 id="section7">Summary</h2>
<p>Using the example of "registering an XML file with Google Search Console," I introduced a method to automate screen operations with Python.<br/>
This method can be useful in scenarios like "performing the same operation repeatedly with software created by historical figures."<br/>
I have personally used this method for work several times, so if you find it useful, please give it a try!</p>



                </div>
                <!-- 広告の部分は表示されるようになってから調整する -->
            </div>
            <div id="right-sidebar">
                <!-- 広告の部分は表示されるようになってから調整する -->
            </div>
            <div id="hidden-right-sidebar"></div>
        </div>
        <!-- 共通: ハンバーガーメニュー -->
        <div id="hamburger-menu"></div>
        <script>$(function(){$('#hamburger-menu').load('../includes/hamburger-menu-en.html');});</script>
        <!-- 共通: フッタ -->
        <footer></footer>
        <script>$(function(){$('footer').load('../includes/footer.html');});</script>
    </div>
    <div class="floating-button">
        <a href="https://twitter.com/intent/tweet?url=https://hitbug0.github.io/posts_en/2024-04-22-AutoAddSitemap2Google.html&text=" class="twitter-share-button" data-show-count="false" rel="noopener noreferrer" target="_blank">
            <img class="twitter-share-button-img" src="../contents/icon/x.png" alt="logo of x">
        </a>
    </div>
  </body>
  <script src="https://code.jquery.com/jquery-3.4.1.min.js" crossorigin="anonymous"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=">
  </script>
  <script src="../includes/clipboard-script.js"></script>
</html>